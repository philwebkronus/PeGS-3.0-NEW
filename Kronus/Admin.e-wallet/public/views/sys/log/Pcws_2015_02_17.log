[2015-02-17 13:55:03.164079][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 13:55:03","Token":"a11a0c02e8dd5ebbaa4568a4f9154f62ca037668"}
[2015-02-17 13:55:03.233840][RESPONSE][ForceLogout] Token: a11a0c02e8dd5ebbaa4568a4f9154f62ca037668, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 13:55:03.234792][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 13:55:03","Token":"a11a0c02e8dd5ebbaa4568a4f9154f62ca037668"}
[2015-02-17 13:55:03.298854][RESPONSE][ForceLogout] Token: a11a0c02e8dd5ebbaa4568a4f9154f62ca037668, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 13:56:04.529664][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 13:56:04","Token":"8d03d55a39c3b19c89539dbeef04d9d97b05a424"}
[2015-02-17 13:56:04.596895][RESPONSE][ForceLogout] Token: 8d03d55a39c3b19c89539dbeef04d9d97b05a424, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 13:56:04.597864][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 13:56:04","Token":"8d03d55a39c3b19c89539dbeef04d9d97b05a424"}
[2015-02-17 13:56:04.664987][RESPONSE][ForceLogout] Token: 8d03d55a39c3b19c89539dbeef04d9d97b05a424, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 14:02:38.523875][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:02:38","Token":"8d1400bfbc700eca4c2956cd8cf73111062b15ec"}
[2015-02-17 14:02:38.596799][RESPONSE][ForceLogout] Token: 8d1400bfbc700eca4c2956cd8cf73111062b15ec, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 14:02:38.597583][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:02:38","Token":"8d1400bfbc700eca4c2956cd8cf73111062b15ec"}
[2015-02-17 14:02:38.650896][RESPONSE][ForceLogout] Token: 8d1400bfbc700eca4c2956cd8cf73111062b15ec, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 14:03:03.28836][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:03:03","Token":"2aa7ee473f9bc31ed1601abc633ca0477577a7cb"}
[2015-02-17 14:03:03.97579][RESPONSE][ForceLogout] Token: 2aa7ee473f9bc31ed1601abc633ca0477577a7cb, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 14:03:03.98535][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:03:03","Token":"2aa7ee473f9bc31ed1601abc633ca0477577a7cb"}
[2015-02-17 14:03:03.154348][RESPONSE][ForceLogout] Token: 2aa7ee473f9bc31ed1601abc633ca0477577a7cb, Output: {"ForceLogout":{"TransactionMessage":"Failed to get AID.","ErrorCode":6}}
[2015-02-17 14:09:17.717105][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:17.888530][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:00 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:17.890680][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.35517][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:00 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.40348][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.189896][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.191886][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.354530][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.356676][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.530949][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.533060][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.709444][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.711397][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:18.872423][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:18.874590][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.29405][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:01 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.31517][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.188487][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.190588][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.341673][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.342698][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.481496][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.482558][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.625139][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.627270][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.774794][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.776893][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:19.905243][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:19.906353][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.44982][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:02 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.46875][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.181615][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.183409][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.311771][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.313457][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.461916][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.463619][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.597455][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.599581][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.737557][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.739931][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:20.874326][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:20.876349][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.15697][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:03 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.17556][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.153822][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:04 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.155134][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.303439][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:04 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.304781][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.446431][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:04 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.447787][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.743150][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:04 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.744478][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:21.924679][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:04 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:21.925965][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.68467][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.84678][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.236392][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.238453][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.369410][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.371527][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.502351][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.504380][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.641583][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.643660][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.778704][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.780978][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:22.919860][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:05 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:22.921484][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.58925][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.60308][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.193942][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.195366][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.329640][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.331066][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.470050][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.471505][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.604769][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.607046][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.742009][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.743216][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:23.874686][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:23.876780][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.19659][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:06 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.21868][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.156084][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.158118][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.290623][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.291914][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.453639][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.454947][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.589110][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.590533][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.734741][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.736286][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.870831][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.872962][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:24.996639][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:07 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:24.998726][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.131310][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.133612][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.263732][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.265767][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.395225][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.397412][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.533875][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.535965][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.674412][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.676358][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.814114][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.816309][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:25.952895][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:08 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:25.955108][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.92477][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.94731][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.234745][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.236744][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.367902][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.370032][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.502879][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.505213][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.643040][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.645088][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.785802][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.788159][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:26.916930][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:09 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:26.919124][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.62143][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.64371][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.197513][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.199655][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.359946][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.362179][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.491353][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.492884][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.635191][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.636636][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.771769][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.772957][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:27.896370][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:27.897475][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.39360][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:10 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.84331][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.216320][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.217558][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.350958][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.352205][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.487877][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.490072][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.619052][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.621421][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.756663][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.758911][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:28.893179][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:28.895360][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.36227][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:11 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.38667][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.161340][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.163614][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.296601][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.298959][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.452082][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.454548][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.586340][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.588715][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.721805][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.723937][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:29.865085][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:29.867294][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.1085][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:12 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.3415][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.129254][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.131433][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.266083][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.268339][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.399045][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.401361][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.536491][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.538666][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.672415][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.674575][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.813250][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.815468][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:30.953305][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:13 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:30.955619][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.90675][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.91927][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.225144][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.226557][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.361439][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.362744][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.497952][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.499387][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.795815][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.798034][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:31.933157][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:14 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:31.935472][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.72792][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.84296][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.221578][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.223761][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.359983][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.362294][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.501227][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.503695][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.641295][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.643565][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.780136][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.782388][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:32.912301][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:32.914586][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.51289][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:15 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.53712][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.189820][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.192153][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.318120][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.320561][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.446183][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.448470][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.581272][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.583598][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.718236][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.720480][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.854342][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.855499][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:33.988305][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:16 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:33.990646][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.221372][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.223643][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.360852][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.362845][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.508447][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.510327][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.655278][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.657156][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.798315][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.800495][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:34.931612][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:17 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:34.933900][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.67236][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.69690][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.210260][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.212614][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.351299][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.353351][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.486512][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.488453][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.632207][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.634215][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.772795][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.774828][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:35.909773][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:35.911794][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.52958][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:18 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.54873][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.190926][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.193039][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.315056][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.317098][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.449374][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.451326][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.584948][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.586950][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.731257][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.733327][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:36.867300][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:36.869222][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.9107][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:19 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.10868][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.148426][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.150348][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.284761][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.286624][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.426791][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.428421][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.565764][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.567559][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.700182][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.702103][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.833547][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.835294][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:37.967313][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:20 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:37.969040][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.100221][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.102102][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.234920][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.236644][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.372180][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.373959][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.506849][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.508701][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.646476][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.648284][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.782880][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.784706][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:38.910094][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:38.911946][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.47507][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:21 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.49497][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.181505][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.183442][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.322172][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.323947][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.454479][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.456294][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.592094][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.594037][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.730527][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.732388][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:39.870016][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:39.871800][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.4929][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:22 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.6675][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.139698][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.141510][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.271848][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.273648][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.405821][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.407544][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.541905][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.543639][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.681575][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.683543][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.822372][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.824080][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:40.961616][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:23 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:40.963567][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.102903][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.104649][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.238507][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.240331][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.378608][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.380520][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.513956][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.515176][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.800287][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.802481][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:41.930559][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:24 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:41.932855][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.65683][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.67935][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.205607][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.207840][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.341964][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.344233][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.472541][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.474665][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.617127][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.619325][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.761703][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.763794][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:42.900858][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:42.902901][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.37295][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:25 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.39409][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.182020][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.184239][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.314983][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.317091][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.449941][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.451992][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.583647][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.586522][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.722333][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.724648][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:43.859362][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:43.861556][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.2354][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:26 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.4499][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.141518][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.143735][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.278798][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.280976][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.414299][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.416612][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.553181][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.554590][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.679681][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.680956][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.824697][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.826852][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:44.964718][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:27 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:44.967048][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.95838][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.98083][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.231043][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.233240][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.370069][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.372106][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.505000][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.507087][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.642207][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.644496][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.785433][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.787667][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:45.925144][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:28 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:45.927476][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.55062][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.57147][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.186843][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.189099][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.322709][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.324894][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.457116][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.459411][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.595243][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.596774][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.739946][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.741374][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:46.873627][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:46.875060][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:47.11690][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:29 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:47.13262][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:47.152075][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:30 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:47.154116][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:47.293948][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:30 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:47.296232][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:47.422599][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:30 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:47.424927][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:09:47.556659][RESPONSE][ForceLogout] Token: 8c57cc853de3d3ffc193d79603128de49473bce6, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:09:30 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:09:47.558536][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:09:17","Token":"8c57cc853de3d3ffc193d79603128de49473bce6"}
[2015-02-17 14:11:51.862205][REQUEST][ForceLogout] Input: {"Login":"753300000003","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:11:51","Token":"360f2eb3960eb06e9566f46f29972f94e9298212"}
[2015-02-17 14:11:52.13473][RESPONSE][ForceLogout] Token: 360f2eb3960eb06e9566f46f29972f94e9298212, Output: <!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>CDbException</title>

<style type="text/css">
/*<![CDATA[*/
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;margin:0;padding:0;}
body{line-height:1;}
ol,ul{list-style:none;}
blockquote,q{quotes:none;}
blockquote:before,blockquote:after,q:before,q:after{content:none;}
:focus{outline:0;}
ins{text-decoration:none;}
del{text-decoration:line-through;}
table{border-collapse:collapse;border-spacing:0;}

body {
	font: normal 9pt "Verdana";
	color: #000;
	background: #fff;
}

h1 {
	font: normal 18pt "Verdana";
	color: #f00;
	margin-bottom: .5em;
}

h2 {
	font: normal 14pt "Verdana";
	color: #800000;
	margin-bottom: .5em;
}

h3 {
	font: bold 11pt "Verdana";
}

pre {
	font: normal 11pt Menlo, Consolas, "Lucida Console", Monospace;
}

pre span.error {
	display: block;
	background: #fce3e3;
}

pre span.ln {
	color: #999;
	padding-right: 0.5em;
	border-right: 1px solid #ccc;
}

pre span.error-ln {
	font-weight: bold;
}

.container {
	margin: 1em 4em;
}

.version {
	color: gray;
	font-size: 8pt;
	border-top: 1px solid #aaa;
	padding-top: 1em;
	margin-bottom: 1em;
}

.message {
	color: #000;
	padding: 1em;
	font-size: 11pt;
	background: #f3f3f3;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	border-radius: 10px;
	margin-bottom: 1em;
	line-height: 160%;
}

.source {
	margin-bottom: 1em;
}

.code pre {
	background-color: #ffe;
	margin: 0.5em 0;
	padding: 0.5em;
	line-height: 125%;
	border: 1px solid #eee;
}

.source .file {
	margin-bottom: 1em;
	font-weight: bold;
}

.traces {
	margin: 2em 0;
}

.trace {
	margin: 0.5em 0;
	padding: 0.5em;
}

.trace.app {
	border: 1px dashed #c00;
}

.trace .number {
	text-align: right;
	width: 2em;
	padding: 0.5em;
}

.trace .content {
	padding: 0.5em;
}

.trace .plus,
.trace .minus {
	display:inline;
	vertical-align:middle;
	text-align:center;
	border:1px solid #000;
	color:#000;
	font-size:10px;
	line-height:10px;
	margin:0;
	padding:0 1px;
	width:10px;
	height:10px;
}

.trace.collapsed .minus,
.trace.expanded .plus,
.trace.collapsed pre {
	display: none;
}

.trace-file {
	cursor: pointer;
	padding: 0.2em;
}

.trace-file:hover {
	background: #f0ffff;
}
/*]]>*/
</style>
</head>

<body>
<div class="container">
	<h1>CDbException</h1>

	<p class="message">
		CDbCommand failed to execute the SQL statement: SQLSTATE[45000]: &lt;&lt;Unknown error&gt;&gt;: 1644 Transaction Failed: Terminal has existing session.. The SQL statement executed was: INSERT INTO transactionrequestlogs (TransactionReferenceID, Amount, StartDate, TransactionType, TerminalID, Status, SiteID, ServiceID, LoyaltyCardNumber, MID, UserMode, PaymentType, PaymentTrackingID, Option1, ServiceTransactionID) VALUES (:trans_ref_id, :amount, NOW(6), :trans_type, :terminal_id, 0, :site_id, :service_id, :loyalty_card, :mid, :user_mode, :paymentType ,:trackingID, :voucher_code, :service_trans_id)	</p>

	<div class="source">
		<p class="file">/var/www/yii/framework/db/CDbCommand.php(354)</p>
		<div class="code"><pre><span class="ln">342</span>             return $n;
<span class="ln">343</span>         }
<span class="ln">344</span>         catch(Exception $e)
<span class="ln">345</span>         {
<span class="ln">346</span>             if($this-&gt;_connection-&gt;enableProfiling)
<span class="ln">347</span>                 Yii::endProfile(&#039;system.db.CDbCommand.execute(&#039;.$this-&gt;getText().&#039;)&#039;,&#039;system.db.CDbCommand.execute&#039;);
<span class="ln">348</span>             $errorInfo = $e instanceof PDOException ? $e-&gt;errorInfo : null;
<span class="ln">349</span>             $message = $e-&gt;getMessage();
<span class="ln">350</span>             Yii::log(Yii::t(&#039;yii&#039;,&#039;CDbCommand::execute() failed: {error}. The SQL statement executed was: {sql}.&#039;,
<span class="ln">351</span>                 array(&#039;{error}&#039;=&gt;$message, &#039;{sql}&#039;=&gt;$this-&gt;getText().$par)),CLogger::LEVEL_ERROR,&#039;system.db.CDbCommand&#039;);
<span class="ln">352</span>             if(YII_DEBUG)
<span class="ln">353</span>                 $message .= &#039;. The SQL statement executed was: &#039;.$this-&gt;getText().$par;
<span class="error"><span class="ln error-ln">354</span>             throw new CDbException(Yii::t(&#039;yii&#039;,&#039;CDbCommand failed to execute the SQL statement: {error}&#039;,
</span><span class="ln">355</span>                 array(&#039;{error}&#039;=&gt;$message)),(int)$e-&gt;getCode(),$errorInfo);
<span class="ln">356</span>         }
<span class="ln">357</span>     }
<span class="ln">358</span> 
<span class="ln">359</span>     /**
<span class="ln">360</span>      * Executes the SQL statement and returns query result.
<span class="ln">361</span>      * This method is for executing an SQL query that returns result set.
<span class="ln">362</span>      * @param array $params input parameters (name=&gt;value) for the SQL execution. This is an alternative
<span class="ln">363</span>      * to {@link bindParam} and {@link bindValue}. If you have multiple input parameters, passing
<span class="ln">364</span>      * them in this way can improve the performance. Note that if you pass parameters in this way,
<span class="ln">365</span>      * you cannot bind parameters or values using {@link bindParam} or {@link bindValue}, and vice versa.
<span class="ln">366</span>      * binding methods and  the input parameters this way can improve the performance.
</pre></div>	</div>

	<div class="traces">
		<h2>Stack Trace</h2>
				<table style="width:100%;">
						<tr class="trace app expanded">
			<td class="number">
				#0			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/models/CommonEWalletTransactionsModel.php(213): <strong>CDbCommand</strong>-><strong>execute</strong>()				</div>

				<div class="code"><pre><span class="ln">208</span>                 &#039;:trackingID&#039;=&gt;$trackingID, &#039;:voucher_code&#039;=&gt;$voucherCode,
<span class="ln">209</span>                 &#039;:paymentType&#039;=&gt;$paymentType,&#039;:service_trans_id&#039;=&gt;$serviceTransactionID);
<span class="ln">210</span> 
<span class="ln">211</span>             $command2 = $this-&gt;connection-&gt;createCommand($sql2);
<span class="ln">212</span>             $command2-&gt;bindValues($param2);
<span class="error"><span class="ln error-ln">213</span>             $command2-&gt;execute();
</span><span class="ln">214</span> 
<span class="ln">215</span>             try {
<span class="ln">216</span>                 $transactionRequestLogID = $this-&gt;connection-&gt;getLastInsertID();
<span class="ln">217</span> 
<span class="ln">218</span>                 $sql3 = &quot;UPDATE transactionsummary SET Withdrawal=:withdrawal, DateEnded=NOW(6) WHERE TransactionsSummaryID=:transactionSummaryID&quot;;
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#1			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/protected/controllers/PcwsController.php(1577): <strong>CommonEWalletTransactionsModel</strong>-><strong>forceLogout</strong>(&quot;3&quot;, &quot;1520&quot;, &quot;19&quot;, &quot;UB8KXXV8&quot;, ...)				</div>

				<div class="code"><pre><span class="ln">1572</span>                                         $serviceTransactionID=&#039;&#039;;
<span class="ln">1573</span>                                         $withdrawal=0;
<span class="ln">1574</span>                                         $amount = 0;
<span class="ln">1575</span>                                         $userMode = $casinoDetails[&#039;UserMode&#039;];
<span class="ln">1576</span> 
<span class="error"><span class="ln error-ln">1577</span>                                         $transactionResult = $eWalletModel-&gt;forceLogout($mid, $terminalID, $serviceID, $cardNumber, $userMode, $transactionReferenceID, $amount, $transactionType, $siteID, $trackingID, $voucherCode, $paymentType, $serviceTransactionID, $AID, $transactionSummaryID, $withdrawal);
</span><span class="ln">1578</span>                                         
<span class="ln">1579</span>                                         if($transactionResult){
<span class="ln">1580</span>                                             $eCode=0;
<span class="ln">1581</span>                                             $casinocontroller-&gt;logout($serviceUsername);
<span class="ln">1582</span>                                         }else{
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#2			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/actions/CInlineAction.php(50): <strong>PcwsController</strong>-><strong>actionForceLogout</strong>()				</div>

				<div class="code"><pre><span class="ln">45</span>         $controller=$this-&gt;getController();
<span class="ln">46</span>         $method=new ReflectionMethod($controller, $methodName);
<span class="ln">47</span>         if($method-&gt;getNumberOfParameters()&gt;0)
<span class="ln">48</span>             return $this-&gt;runWithParamsInternal($controller, $method, $params);
<span class="ln">49</span>         else
<span class="error"><span class="ln error-ln">50</span>             return $controller-&gt;$methodName();
</span><span class="ln">51</span>     }
<span class="ln">52</span> 
<span class="ln">53</span> }
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#3			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(309): <strong>CInlineAction</strong>-><strong>runWithParams</strong>(array())				</div>

				<div class="code"><pre><span class="ln">304</span>     {
<span class="ln">305</span>         $priorAction=$this-&gt;_action;
<span class="ln">306</span>         $this-&gt;_action=$action;
<span class="ln">307</span>         if($this-&gt;beforeAction($action))
<span class="ln">308</span>         {
<span class="error"><span class="ln error-ln">309</span>             if($action-&gt;runWithParams($this-&gt;getActionParams())===false)
</span><span class="ln">310</span>                 $this-&gt;invalidActionParams($action);
<span class="ln">311</span>             else
<span class="ln">312</span>                 $this-&gt;afterAction($action);
<span class="ln">313</span>         }
<span class="ln">314</span>         $this-&gt;_action=$priorAction;
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#4			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(287): <strong>CController</strong>-><strong>runAction</strong>(CInlineAction)				</div>

				<div class="code"><pre><span class="ln">282</span>      * @see runAction
<span class="ln">283</span>      */
<span class="ln">284</span>     public function runActionWithFilters($action,$filters)
<span class="ln">285</span>     {
<span class="ln">286</span>         if(empty($filters))
<span class="error"><span class="ln error-ln">287</span>             $this-&gt;runAction($action);
</span><span class="ln">288</span>         else
<span class="ln">289</span>         {
<span class="ln">290</span>             $priorAction=$this-&gt;_action;
<span class="ln">291</span>             $this-&gt;_action=$action;
<span class="ln">292</span>             CFilterChain::create($this,$action,$filters)-&gt;run();
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#5			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CController.php(266): <strong>CController</strong>-><strong>runActionWithFilters</strong>(CInlineAction, array())				</div>

				<div class="code"><pre><span class="ln">261</span>         {
<span class="ln">262</span>             if(($parent=$this-&gt;getModule())===null)
<span class="ln">263</span>                 $parent=Yii::app();
<span class="ln">264</span>             if($parent-&gt;beforeControllerAction($this,$action))
<span class="ln">265</span>             {
<span class="error"><span class="ln error-ln">266</span>                 $this-&gt;runActionWithFilters($action,$this-&gt;filters());
</span><span class="ln">267</span>                 $parent-&gt;afterControllerAction($this,$action);
<span class="ln">268</span>             }
<span class="ln">269</span>         }
<span class="ln">270</span>         else
<span class="ln">271</span>             $this-&gt;missingAction($actionID);
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#6			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(276): <strong>CController</strong>-><strong>run</strong>(&quot;forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">271</span>         {
<span class="ln">272</span>             list($controller,$actionID)=$ca;
<span class="ln">273</span>             $oldController=$this-&gt;_controller;
<span class="ln">274</span>             $this-&gt;_controller=$controller;
<span class="ln">275</span>             $controller-&gt;init();
<span class="error"><span class="ln error-ln">276</span>             $controller-&gt;run($actionID);
</span><span class="ln">277</span>             $this-&gt;_controller=$oldController;
<span class="ln">278</span>         }
<span class="ln">279</span>         else
<span class="ln">280</span>             throw new CHttpException(404,Yii::t(&#039;yii&#039;,&#039;Unable to resolve the request &quot;{route}&quot;.&#039;,
<span class="ln">281</span>                 array(&#039;{route}&#039;=&gt;$route===&#039;&#039;?$this-&gt;defaultController:$route)));
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#7			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/web/CWebApplication.php(135): <strong>CWebApplication</strong>-><strong>runController</strong>(&quot;pcws/forcelogout&quot;)				</div>

				<div class="code"><pre><span class="ln">130</span>             foreach(array_splice($this-&gt;catchAllRequest,1) as $name=&gt;$value)
<span class="ln">131</span>                 $_GET[$name]=$value;
<span class="ln">132</span>         }
<span class="ln">133</span>         else
<span class="ln">134</span>             $route=$this-&gt;getUrlManager()-&gt;parseUrl($this-&gt;getRequest());
<span class="error"><span class="ln error-ln">135</span>         $this-&gt;runController($route);
</span><span class="ln">136</span>     }
<span class="ln">137</span> 
<span class="ln">138</span>     /**
<span class="ln">139</span>      * Registers the core application components.
<span class="ln">140</span>      * This method overrides the parent implementation by registering additional core components.
</pre></div>			</td>
		</tr>
						<tr class="trace core collapsed">
			<td class="number">
				#8			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/yii/framework/base/CApplication.php(162): <strong>CWebApplication</strong>-><strong>processRequest</strong>()				</div>

				<div class="code"><pre><span class="ln">157</span>      */
<span class="ln">158</span>     public function run()
<span class="ln">159</span>     {
<span class="ln">160</span>         if($this-&gt;hasEventHandler(&#039;onBeginRequest&#039;))
<span class="ln">161</span>             $this-&gt;onBeginRequest(new CEvent($this));
<span class="error"><span class="ln error-ln">162</span>         $this-&gt;processRequest();
</span><span class="ln">163</span>         if($this-&gt;hasEventHandler(&#039;onEndRequest&#039;))
<span class="ln">164</span>             $this-&gt;onEndRequest(new CEvent($this));
<span class="ln">165</span>     }
<span class="ln">166</span> 
<span class="ln">167</span>     /**
</pre></div>			</td>
		</tr>
						<tr class="trace app expanded">
			<td class="number">
				#9			</td>
			<td class="content">
				<div class="trace-file">
											<div class="plus">+</div>
						<div class="minus">–</div>
										&nbsp;/var/www/PCWS/index.php(13): <strong>CApplication</strong>-><strong>run</strong>()				</div>

				<div class="code"><pre><span class="ln">08</span> defined(&#039;YII_DEBUG&#039;) or define(&#039;YII_DEBUG&#039;,true);
<span class="ln">09</span> // specify how many levels of call stack should be shown in each log message
<span class="ln">10</span> defined(&#039;YII_TRACE_LEVEL&#039;) or define(&#039;YII_TRACE_LEVEL&#039;,3);
<span class="ln">11</span> 
<span class="ln">12</span> require_once($yii);
<span class="error"><span class="ln error-ln">13</span> Yii::createWebApplication($config)-&gt;run();
</span></pre></div>			</td>
		</tr>
				</table>
	</div>

	<div class="version">
		2015-02-17 14:11:34 Apache/2.2.14 (Ubuntu) <a href="http://www.yiiframework.com/">Yii Framework</a>/1.1.11-dev	</div>
</div>

<script type="text/javascript">
/*<![CDATA[*/
var traceReg = new RegExp("(^|\\s)trace-file(\\s|$)");
var collapsedReg = new RegExp("(^|\\s)collapsed(\\s|$)");

var e = document.getElementsByTagName("div");
for(var j=0,len=e.length;j<len;j++){
	if(traceReg.test(e[j].className)){
		e[j].onclick = function(){
			var trace = this.parentNode.parentNode;
			if(collapsedReg.test(trace.className))
				trace.className = trace.className.replace("collapsed", "expanded");
			else
				trace.className = trace.className.replace("expanded", "collapsed");
		}
	}
}
/*]]>*/
</script>

</body>
</html>

[2015-02-17 14:23:15.173392][REQUEST][ForceLogout] Input: {"Login":"346300000049","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:23:15","Token":"6625bd3b712195fede95eedf2d6d9f3363e111de"}
[2015-02-17 14:23:15.869407][RESPONSE][ForceLogout] Token: 6625bd3b712195fede95eedf2d6d9f3363e111de, Output: {"ForceLogout":{"TransactionMessage":"Transaction successful (all transaction) \/ valid","ErrorCode":0}}
[2015-02-17 14:37:32.855100][REQUEST][ForceLogout] Input: {"Login":"346300000049","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:37:32","Token":"3c26530e921cd50c3608adcc1d389f0b4c81ed62"}
[2015-02-17 14:37:33.26328][RESPONSE][ForceLogout] Token: 3c26530e921cd50c3608adcc1d389f0b4c81ed62, Output: {"ForceLogout":{"TransactionMessage":"Transaction successful (all transaction) \/ valid","ErrorCode":0}}
[2015-02-17 14:44:59.534066][REQUEST][ForceLogout] Input: {"Login":"346300000049","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:44:59","Token":"18c05e340ab4c00b3f865658f1ea0270f797df43"}
[2015-02-17 14:44:59.708415][RESPONSE][ForceLogout] Token: 18c05e340ab4c00b3f865658f1ea0270f797df43, Output: {"ForceLogout":{"TransactionMessage":"Transaction successful (all transaction) \/ valid","ErrorCode":0}}
[2015-02-17 14:46:38.359290][REQUEST][ForceLogout] Input: {"Login":"346300000049","SystemUsername":"kadmin","AccessDate":"2015-02-17 14:46:38","Token":"7eb52f6e4cd7350fa21a674cae0374feed7a6989"}
[2015-02-17 14:46:38.536376][RESPONSE][ForceLogout] Token: 7eb52f6e4cd7350fa21a674cae0374feed7a6989, Output: {"ForceLogout":{"TransactionMessage":"Transaction successful (all transaction) \/ valid","ErrorCode":0}}
